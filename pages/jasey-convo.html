---
layout: default
permalink: /jasey-convo/
---

<body data-count="0">
	<style>
		header {
			position: sticky;
			top: 0;
			background-color: white;
			box-shadow: 2px 5px 15px #0003;
			padding: 1em;
		}

		body {
			margin: 0;
		}

		h1 {
			margin: 0;
			margin-bottom: 1em;
		}

		#list {
			max-width: 69ch;
			margin: auto;
			margin-top: 2em;
			font-family: sans;
		}

		dt {
			font-weight: bold;
			margin-top: 1em;
			padding: 0.25em;
			font-size: 0.9em;
		}

		dd {
			margin-left: 0;
			padding: 1em;
		}
	</style>
	<header>
		<h1>Telegram messages</h1>
		<button id="prev">Show prev 50 items</button>
		<button id="next">Show next 50 items</button>
	</header>
	<dl id="list"></dl>

	<script>
		let messages = []
        document.body.dataset.count = 0
		fetch('/files/result.json')
			.then((e) => e.json())
			.then((response) => {
				const msg = response.messages
				const searchResults = response.messages.filter(
					(item) => item.text.includes('HAHA') || item.text.includes('haha')
				)

				// searchResults.forEach(item => renderMessageItem(item))
				messages = searchResults
			})

		const list = document.getElementById('list')
		const formatter = new Intl.DateTimeFormat('en-US', {
			dateStyle: 'long',
			timeStyle: 'short',
		})
		function renderMessageItem(item) {
			const messageItem = `<dt>${item.from}</dt></dd>${
				item.text
			} <time datetime="${item.date}">${formatter.format(
				new Date(item.date)
			)}</time></dd>`
			console.log(messageItem)

			list.innerHTML += messageItem
		}

		next.addEventListener('click', (e) => {
			document.body.dataset.count = +document.body.dataset.count + 1
			renderList()
		})

		prev.addEventListener('click', (e) => {
			document.body.dataset.count = +document.body.dataset.count - 1
			renderList()
		})

		function renderList() {
			const startIndex = +document.body.dataset.count * 50
			const endIndex = (+document.body.dataset.count + 1) * 50
			const array = messages.slice(startIndex, endIndex)

			list.innerHTML = ''
			array.forEach((item) => renderListItem(item))
		}

		function renderListItem(item) {
			const listItem = `<dt>${item.from}</dt><dd>${item.text}</dd>`
			list.innerHTML += listItem
		}
	</script>
</body>
